{"version":3,"sources":["../src/course_participation.js"],"names":["define","$","Log","Ajax","Selectors","bulkActionSelect","bulkUserSelectedCheckBoxes","participantsForm","messageSelect","CourseParticipation","off","on","e","preventDefault","action","target","value","checkboxes","find","append","ids","each","push","parseInt","attr","replace","json","JSON","stringify","call","methodname","args","userids","done","response","window","location","fail","reason","debug","init"],"mappings":"AAuBAA,OAAM,uCAAC,CAAC,QAAD,CAAW,UAAX,CAAuB,WAAvB,CAAD,CAAsC,SAAUC,CAAV,CAAaC,CAAb,CAAkBC,CAAlB,CAAwB,CAM5D,GAAIC,CAAAA,CAAS,CAAG,CACZC,gBAAgB,CAAE,eADN,CAEZC,0BAA0B,CAAE,oEAFhB,CAGZC,gBAAgB,CAAE,mBAHN,CAIZC,aAAa,CAAE,gBAJH,CAAhB,CAOA,QAASC,CAAAA,CAAT,EAA+B,CAE3BR,CAAC,CAACG,CAAS,CAACC,gBAAX,CAAD,CAA8BK,GAA9B,GAEAT,CAAC,CAACG,CAAS,CAACC,gBAAX,CAAD,CAA8BM,EAA9B,CAAiC,QAAjC,CAA2C,SAASC,CAAT,CAAY,CACnDA,CAAC,CAACC,cAAF,GADmD,GAG7CC,CAAAA,CAAM,CAAGF,CAAC,CAACG,MAAF,CAASC,KAH2B,CAI/CC,CAAU,CAAGhB,CAAC,CAACG,CAAS,CAACG,gBAAX,CAAD,CAA8BW,IAA9B,CAAmCd,CAAS,CAACE,0BAA7C,CAJkC,CAMnD,GAAIQ,CAAM,GAAKV,CAAS,CAACI,aAAzB,CAAwC,CAEpCP,CAAC,CAAC,MAAD,CAAD,CAAUkB,MAAV,CAAiB,oFAAjB,EAEA,GAAIC,CAAAA,CAAG,CAAG,EAAV,CACAH,CAAU,CAACI,IAAX,CAAgB,UAAkB,CAC9BD,CAAG,CAACE,IAAJ,CAASC,QAAQ,CAACtB,CAAC,CAAC,IAAD,CAAD,CAAQuB,IAAR,CAAa,MAAb,EAAqBC,OAArB,CAA6B,MAA7B,CAAqC,EAArC,CAAD,CAAjB,CACH,CAFD,EAGA,GAAIC,CAAAA,CAAI,CAAGC,IAAI,CAACC,SAAL,CAAeR,CAAf,CAAX,CAGAjB,CAAI,CAAC0B,IAAL,CAAU,CAAC,CACPC,UAAU,CAAE,uCADL,CAEPC,IAAI,CAAE,CAAEC,OAAO,CAAEN,CAAX,CAFC,CAGPO,IAAI,CAAE,cAASC,CAAT,CAAmB,CAErBC,MAAM,CAACC,QAAP,CAAgBX,OAAhB,CAAwB,+CAAiDS,CAAzE,CACH,CANM,CAOPG,IAAI,CAAE,cAASC,CAAT,CAAiB,CACnBpC,CAAG,CAACqC,KAAJ,CAAUD,CAAV,CACH,CATM,CAAD,CAAV,CAWH,CAEJ,CA9BD,CAkCH,CAED,MAAO,CACHE,IAAI,CApDR,UAAgB,CACE,GAAI/B,CAAAA,CACrB,CAiDM,CAGV,CAxDC,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Create an announcement draft audience from the course participation page.\n *\n * @package    theme_boostcgs\n * @copyright  Michael Vangelovski\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/log', 'core/ajax'], function ($, Log, Ajax) {\n\n        function init() {\n            var control = new CourseParticipation();\n        }\n\n        var Selectors = {\n            bulkActionSelect: \"#formactionid\",\n            bulkUserSelectedCheckBoxes: \"input.usercheckbox[data-togglegroup^='participants-table']:checked\",\n            participantsForm: '#participantsform',\n            messageSelect: '#messageselect',\n        };\n\n        function CourseParticipation() {\n\n            $(Selectors.bulkActionSelect).off();\n\n            $(Selectors.bulkActionSelect).on('change', function(e) {\n                e.preventDefault();\n\n                const action = e.target.value;\n                var checkboxes = $(Selectors.participantsForm).find(Selectors.bulkUserSelectedCheckBoxes);\n   \n                if (action === Selectors.messageSelect) {\n                    // Stop modal and backdrop from showing.\n                    $('body').append('<style type=\"text/css\">.modal,.modal-backdrop{display: none !important;}</style>');\n\n                    var ids = [];\n                    checkboxes.each(function( index ) {\n                        ids.push(parseInt($(this).attr('name').replace('user', '')));\n                    });\n                    var json = JSON.stringify(ids);\n\n                    // Create the draftaudience.\n                    Ajax.call([{\n                        methodname: 'local_announcements_set_draftaudience',\n                        args: { userids: json },\n                        done: function(response) {\n                            // Redirect to post announcement.\n                            window.location.replace('/local/announcements/post.php?draftaudience=' + response);\n                        },\n                        fail: function(reason) {\n                            Log.debug(reason);\n                        }\n                    }]);\n                }\n\n            });\n\n\n\n        };\n\n        return {\n            init: init\n        };\n    });"],"file":"course_participation.min.js"}